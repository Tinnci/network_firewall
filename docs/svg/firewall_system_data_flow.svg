<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: Firewall_System_Data_Flow Pages: 1 -->
<svg width="396pt" height="1353pt"
 viewBox="0.00 0.00 395.50 1353.08" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1349.08)">
<title>Firewall_System_Data_Flow</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1349.08 391.5,-1349.08 391.5,4 -4,4"/>
<text text-anchor="middle" x="193.75" y="-1322.08" font-family="Microsoft YaHei" font-size="20.00">防火墙系统数据流程图</text>
<!-- Start -->
<g id="node1" class="node">
<title>Start</title>
<polygon fill="lightblue" stroke="black" points="240.01,-1310.08 49.11,-1310.08 0,-1256.58 190.9,-1256.58 240.01,-1310.08"/>
<text text-anchor="middle" x="120" y="-1279.41" font-family="Microsoft YaHei" font-size="14.00">网络数据包到达</text>
</g>
<!-- PyDivertCapture -->
<g id="node2" class="node">
<title>PyDivertCapture</title>
<polygon fill="lightgreen" stroke="black" points="184.63,-1219.58 55.38,-1219.58 55.38,-1183.58 184.63,-1183.58 184.63,-1219.58"/>
<text text-anchor="middle" x="120" y="-1197.66" font-family="Microsoft YaHei" font-size="14.00">PyDivert驱动捕获</text>
</g>
<!-- Start&#45;&gt;PyDivertCapture -->
<g id="edge1" class="edge">
<title>Start&#45;&gt;PyDivertCapture</title>
<path fill="none" stroke="black" d="M120,-1256.22C120,-1248.16 120,-1239.25 120,-1231.04"/>
<polygon fill="black" stroke="black" points="123.5,-1231.21 120,-1221.21 116.5,-1231.21 123.5,-1231.21"/>
</g>
<!-- InterceptorReceive -->
<g id="node3" class="node">
<title>InterceptorReceive</title>
<polygon fill="lightgreen" stroke="red" stroke-width="2" points="222.5,-1146.58 17.5,-1146.58 17.5,-1110.58 222.5,-1110.58 222.5,-1146.58"/>
<text text-anchor="middle" x="120" y="-1124.66" font-family="Microsoft YaHei" font-size="14.00">PacketInterceptor接收数据包</text>
</g>
<!-- PyDivertCapture&#45;&gt;InterceptorReceive -->
<g id="edge2" class="edge">
<title>PyDivertCapture&#45;&gt;InterceptorReceive</title>
<path fill="none" stroke="black" d="M120,-1183.39C120,-1175.92 120,-1166.95 120,-1158.5"/>
<polygon fill="black" stroke="black" points="123.5,-1158.62 120,-1148.62 116.5,-1158.62 123.5,-1158.62"/>
</g>
<!-- ProcessorHandle -->
<g id="node4" class="node">
<title>ProcessorHandle</title>
<polygon fill="lightgreen" stroke="black" points="210.5,-1055.83 29.5,-1055.83 29.5,-1019.83 210.5,-1019.83 210.5,-1055.83"/>
<text text-anchor="middle" x="120" y="-1033.91" font-family="Microsoft YaHei" font-size="14.00">PacketProcessor处理请求</text>
</g>
<!-- InterceptorReceive&#45;&gt;ProcessorHandle -->
<g id="edge3" class="edge">
<title>InterceptorReceive&#45;&gt;ProcessorHandle</title>
<path fill="none" stroke="black" d="M120,-1109.62C120,-1097.55 120,-1081.39 120,-1067.56"/>
<polygon fill="black" stroke="black" points="123.5,-1067.67 120,-1057.67 116.5,-1067.67 123.5,-1067.67"/>
<text text-anchor="middle" x="155.63" y="-1079.28" font-family="Microsoft YaHei" font-size="14.00">原始数据包</text>
</g>
<!-- AnalyzerRequest -->
<g id="node5" class="node">
<title>AnalyzerRequest</title>
<path fill="lightyellow" stroke="black" d="M194.75,-982.83C194.75,-982.83 45.25,-982.83 45.25,-982.83 39.25,-982.83 33.25,-976.83 33.25,-970.83 33.25,-970.83 33.25,-958.83 33.25,-958.83 33.25,-952.83 39.25,-946.83 45.25,-946.83 45.25,-946.83 194.75,-946.83 194.75,-946.83 200.75,-946.83 206.75,-952.83 206.75,-958.83 206.75,-958.83 206.75,-970.83 206.75,-970.83 206.75,-976.83 200.75,-982.83 194.75,-982.83"/>
<text text-anchor="middle" x="120" y="-960.91" font-family="Microsoft YaHei" font-size="14.00">请求PacketAnalyzer分析</text>
</g>
<!-- ProcessorHandle&#45;&gt;AnalyzerRequest -->
<g id="edge4" class="edge">
<title>ProcessorHandle&#45;&gt;AnalyzerRequest</title>
<path fill="none" stroke="black" d="M120,-1019.64C120,-1012.06 120,-1002.93 120,-994.37"/>
<polygon fill="black" stroke="black" points="123.5,-994.37 120,-984.37 116.5,-994.37 123.5,-994.37"/>
</g>
<!-- AnalyzerAnalyze -->
<g id="node7" class="node">
<title>AnalyzerAnalyze</title>
<polygon fill="lightgreen" stroke="red" stroke-width="2" points="314,-892.08 112,-892.08 112,-846.58 314,-846.58 314,-892.08"/>
<text text-anchor="middle" x="213" y="-874.78" font-family="Microsoft YaHei" font-size="14.00">PacketAnalyzer执行规则匹配</text>
<text text-anchor="middle" x="213" y="-856.03" font-family="Microsoft YaHei" font-size="14.00">(协议, IP, 端口, 内容)</text>
</g>
<!-- AnalyzerRequest&#45;&gt;AnalyzerAnalyze -->
<g id="edge6" class="edge">
<title>AnalyzerRequest&#45;&gt;AnalyzerAnalyze</title>
<path fill="none" stroke="black" d="M137.06,-946.68C149.72,-933.96 167.31,-916.27 182.38,-901.12"/>
<polygon fill="black" stroke="black" points="184.81,-903.64 189.38,-894.09 179.84,-898.71 184.81,-903.64"/>
<text text-anchor="middle" x="193.45" y="-915.53" font-family="Microsoft YaHei" font-size="14.00">数据包</text>
</g>
<!-- RuleManagerAccess -->
<g id="node6" class="node">
<title>RuleManagerAccess</title>
<polygon fill="lightgreen" stroke="black" points="387.5,-982.83 224.5,-982.83 224.5,-946.83 387.5,-946.83 387.5,-982.83"/>
<text text-anchor="middle" x="306" y="-960.91" font-family="Microsoft YaHei" font-size="14.00">RuleManager提供规则</text>
</g>
<!-- RuleManagerAccess&#45;&gt;AnalyzerAnalyze -->
<g id="edge5" class="edge">
<title>RuleManagerAccess&#45;&gt;AnalyzerAnalyze</title>
<path fill="none" stroke="black" d="M288.95,-946.68C276.29,-933.96 258.7,-916.27 243.63,-901.12"/>
<polygon fill="black" stroke="black" points="246.17,-898.71 236.63,-894.09 241.2,-903.64 246.17,-898.71"/>
<text text-anchor="middle" x="299.07" y="-915.53" font-family="Microsoft YaHei" font-size="14.00">当前规则</text>
</g>
<!-- AnalyzerResult -->
<g id="node8" class="node">
<title>AnalyzerResult</title>
<path fill="lightyellow" stroke="black" d="M302,-809.58C302,-809.58 124,-809.58 124,-809.58 118,-809.58 112,-803.58 112,-797.58 112,-797.58 112,-776.08 112,-776.08 112,-770.08 118,-764.08 124,-764.08 124,-764.08 302,-764.08 302,-764.08 308,-764.08 314,-770.08 314,-776.08 314,-776.08 314,-797.58 314,-797.58 314,-803.58 308,-809.58 302,-809.58"/>
<text text-anchor="middle" x="213" y="-792.28" font-family="Microsoft YaHei" font-size="14.00">PacketAnalyzer返回分析结果</text>
<text text-anchor="middle" x="213" y="-773.53" font-family="Microsoft YaHei" font-size="14.00">(允许/拦截)</text>
</g>
<!-- AnalyzerAnalyze&#45;&gt;AnalyzerResult -->
<g id="edge7" class="edge">
<title>AnalyzerAnalyze&#45;&gt;AnalyzerResult</title>
<path fill="none" stroke="black" d="M213,-845.91C213,-838.25 213,-829.52 213,-821.2"/>
<polygon fill="black" stroke="black" points="216.5,-821.37 213,-811.37 209.5,-821.37 216.5,-821.37"/>
</g>
<!-- ProcessorAction -->
<g id="node9" class="node">
<title>ProcessorAction</title>
<polygon fill="lightgreen" stroke="red" stroke-width="2" points="303.5,-727.08 122.5,-727.08 122.5,-691.08 303.5,-691.08 303.5,-727.08"/>
<text text-anchor="middle" x="213" y="-705.16" font-family="Microsoft YaHei" font-size="14.00">PacketProcessor执行动作</text>
</g>
<!-- AnalyzerResult&#45;&gt;ProcessorAction -->
<g id="edge8" class="edge">
<title>AnalyzerResult&#45;&gt;ProcessorAction</title>
<path fill="none" stroke="black" d="M213,-763.92C213,-756.17 213,-747.33 213,-739.08"/>
<polygon fill="black" stroke="black" points="216.5,-739.13 213,-729.13 209.5,-739.13 216.5,-739.13"/>
</g>
<!-- DecisionAllow -->
<g id="node10" class="node">
<title>DecisionAllow</title>
<polygon fill="lightcoral" stroke="red" stroke-width="2" points="213,-654.08 133.25,-627.33 213,-600.58 292.75,-627.33 213,-654.08"/>
<text text-anchor="middle" x="213" y="-623.41" font-family="Microsoft YaHei" font-size="14.00">是否允许?</text>
</g>
<!-- ProcessorAction&#45;&gt;DecisionAllow -->
<g id="edge9" class="edge">
<title>ProcessorAction&#45;&gt;DecisionAllow</title>
<path fill="none" stroke="black" d="M213,-690.38C213,-683.25 213,-674.73 213,-666.33"/>
<polygon fill="black" stroke="black" points="216.5,-666.59 213,-656.59 209.5,-666.59 216.5,-666.59"/>
</g>
<!-- InterceptorSend -->
<g id="node11" class="node">
<title>InterceptorSend</title>
<polygon fill="lightgreen" stroke="black" points="250.5,-545.83 45.5,-545.83 45.5,-509.83 250.5,-509.83 250.5,-545.83"/>
<text text-anchor="middle" x="148" y="-523.91" font-family="Microsoft YaHei" font-size="14.00">PacketInterceptor发送数据包</text>
</g>
<!-- DecisionAllow&#45;&gt;InterceptorSend -->
<g id="edge10" class="edge">
<title>DecisionAllow&#45;&gt;InterceptorSend</title>
<path fill="none" stroke="black" d="M198.58,-604.69C188.94,-590.24 176.2,-571.13 165.92,-555.71"/>
<polygon fill="black" stroke="black" points="168.87,-553.83 160.42,-547.45 163.05,-557.71 168.87,-553.83"/>
<text text-anchor="middle" x="210.58" y="-569.28" font-family="Microsoft YaHei" font-size="14.00">是 (允许)</text>
</g>
<!-- PacketDrop -->
<g id="node14" class="node">
<title>PacketDrop</title>
<ellipse fill="palegreen" stroke="red" stroke-width="2" cx="278" cy="-472.92" rx="61.7" ry="18.92"/>
<text text-anchor="middle" x="278" y="-468.99" font-family="Microsoft YaHei" font-size="14.00">数据包丢弃</text>
</g>
<!-- DecisionAllow&#45;&gt;PacketDrop -->
<g id="edge14" class="edge">
<title>DecisionAllow&#45;&gt;PacketDrop</title>
<path fill="none" stroke="black" d="M228.7,-604.98C233.54,-598 238.72,-590.11 243,-582.58 251.9,-566.94 254.02,-562.8 260,-545.83 264.79,-532.26 268.83,-516.83 271.86,-503.75"/>
<polygon fill="black" stroke="black" points="275.28,-504.52 274.03,-494 268.44,-503 275.28,-504.52"/>
<text text-anchor="middle" x="280.92" y="-569.28" font-family="Microsoft YaHei" font-size="14.00">否 (拦截)</text>
</g>
<!-- PyDivertInject -->
<g id="node12" class="node">
<title>PyDivertInject</title>
<polygon fill="lightgreen" stroke="black" points="243,-436 71,-436 71,-400 243,-400 243,-436"/>
<text text-anchor="middle" x="157" y="-414.07" font-family="Microsoft YaHei" font-size="14.00">PyDivert驱动注入数据包</text>
</g>
<!-- InterceptorSend&#45;&gt;PyDivertInject -->
<g id="edge11" class="edge">
<title>InterceptorSend&#45;&gt;PyDivertInject</title>
<path fill="none" stroke="black" d="M149.45,-509.51C150.84,-492.84 152.97,-467.35 154.61,-447.66"/>
<polygon fill="black" stroke="black" points="158.09,-448.05 155.44,-437.79 151.12,-447.46 158.09,-448.05"/>
</g>
<!-- PacketOut -->
<g id="node13" class="node">
<title>PacketOut</title>
<polygon fill="lightblue" stroke="red" stroke-width="2" points="250.46,-363 106.56,-363 69.55,-309.5 213.44,-309.5 250.46,-363"/>
<text text-anchor="middle" x="160" y="-332.32" font-family="Microsoft YaHei" font-size="14.00">数据包发出</text>
</g>
<!-- PyDivertInject&#45;&gt;PacketOut -->
<g id="edge12" class="edge">
<title>PyDivertInject&#45;&gt;PacketOut</title>
<path fill="none" stroke="black" d="M157.66,-399.7C157.93,-392.51 158.25,-383.88 158.57,-375.35"/>
<polygon fill="black" stroke="black" points="162.07,-375.57 158.94,-365.45 155.07,-375.31 162.07,-375.57"/>
</g>
<!-- UpdateStats -->
<g id="node15" class="node">
<title>UpdateStats</title>
<path fill="lightyellow" stroke="black" d="M257.75,-272.5C257.75,-272.5 180.25,-272.5 180.25,-272.5 174.25,-272.5 168.25,-266.5 168.25,-260.5 168.25,-260.5 168.25,-248.5 168.25,-248.5 168.25,-242.5 174.25,-236.5 180.25,-236.5 180.25,-236.5 257.75,-236.5 257.75,-236.5 263.75,-236.5 269.75,-242.5 269.75,-248.5 269.75,-248.5 269.75,-260.5 269.75,-260.5 269.75,-266.5 263.75,-272.5 257.75,-272.5"/>
<text text-anchor="middle" x="219" y="-250.57" font-family="Microsoft YaHei" font-size="14.00">更新统计信息</text>
</g>
<!-- PacketOut&#45;&gt;UpdateStats -->
<g id="edge13" class="edge">
<title>PacketOut&#45;&gt;UpdateStats</title>
<path fill="none" stroke="black" d="M179.65,-308.69C185.98,-300.13 193,-290.65 199.33,-282.09"/>
<polygon fill="black" stroke="black" points="202.09,-284.25 205.22,-274.13 196.46,-280.09 202.09,-284.25"/>
</g>
<!-- PacketDrop&#45;&gt;UpdateStats -->
<g id="edge15" class="edge">
<title>PacketDrop&#45;&gt;UpdateStats</title>
<path fill="none" stroke="black" d="M278.88,-453.14C279.66,-422.09 278.44,-358.6 259,-309.5 255.07,-299.57 248.84,-289.84 242.45,-281.43"/>
<polygon fill="black" stroke="black" points="245.24,-279.32 236.24,-273.74 239.8,-283.72 245.24,-279.32"/>
</g>
<!-- LogEvent -->
<g id="node16" class="node">
<title>LogEvent</title>
<path fill="lightyellow" stroke="black" d="M257.75,-199.5C257.75,-199.5 180.25,-199.5 180.25,-199.5 174.25,-199.5 168.25,-193.5 168.25,-187.5 168.25,-187.5 168.25,-175.5 168.25,-175.5 168.25,-169.5 174.25,-163.5 180.25,-163.5 180.25,-163.5 257.75,-163.5 257.75,-163.5 263.75,-163.5 269.75,-169.5 269.75,-175.5 269.75,-175.5 269.75,-187.5 269.75,-187.5 269.75,-193.5 263.75,-199.5 257.75,-199.5"/>
<text text-anchor="middle" x="219" y="-177.57" font-family="Microsoft YaHei" font-size="14.00">记录日志事件</text>
</g>
<!-- UpdateStats&#45;&gt;LogEvent -->
<g id="edge16" class="edge">
<title>UpdateStats&#45;&gt;LogEvent</title>
<path fill="none" stroke="black" d="M219,-236.31C219,-228.73 219,-219.6 219,-211.04"/>
<polygon fill="black" stroke="black" points="222.5,-211.04 219,-201.04 215.5,-211.04 222.5,-211.04"/>
</g>
<!-- UICallback -->
<g id="node17" class="node">
<title>UICallback</title>
<path fill="lightyellow" stroke="black" d="M288.88,-126.5C288.88,-126.5 149.13,-126.5 149.13,-126.5 143.13,-126.5 137.13,-120.5 137.13,-114.5 137.13,-114.5 137.13,-102.5 137.13,-102.5 137.13,-96.5 143.13,-90.5 149.13,-90.5 149.13,-90.5 288.88,-90.5 288.88,-90.5 294.88,-90.5 300.88,-96.5 300.88,-102.5 300.88,-102.5 300.88,-114.5 300.88,-114.5 300.88,-120.5 294.88,-126.5 288.88,-126.5"/>
<text text-anchor="middle" x="219" y="-104.58" font-family="Microsoft YaHei" font-size="14.00">触发UI回调 (流量/日志)</text>
</g>
<!-- LogEvent&#45;&gt;UICallback -->
<g id="edge17" class="edge">
<title>LogEvent&#45;&gt;UICallback</title>
<path fill="none" stroke="black" d="M219,-163.31C219,-155.73 219,-146.6 219,-138.04"/>
<polygon fill="black" stroke="black" points="222.5,-138.04 219,-128.04 215.5,-138.04 222.5,-138.04"/>
</g>
<!-- UIUpdate -->
<g id="node18" class="node">
<title>UIUpdate</title>
<polygon fill="lightblue" stroke="red" stroke-width="2" points="309.46,-53.5 165.56,-53.5 128.55,0 272.44,0 309.46,-53.5"/>
<text text-anchor="middle" x="219" y="-22.82" font-family="Microsoft YaHei" font-size="14.00">UI界面更新</text>
</g>
<!-- UICallback&#45;&gt;UIUpdate -->
<g id="edge18" class="edge">
<title>UICallback&#45;&gt;UIUpdate</title>
<path fill="none" stroke="black" d="M219,-90.2C219,-83.01 219,-74.38 219,-65.85"/>
<polygon fill="black" stroke="black" points="222.5,-65.95 219,-55.95 215.5,-65.95 222.5,-65.95"/>
</g>
</g>
</svg>
