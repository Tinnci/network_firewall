<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: Firewall_Packet_Flow Pages: 1 -->
<svg width="871pt" height="2045pt"
 viewBox="0.00 0.00 870.78 2044.57" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2040.57)">
<title>Firewall_Packet_Flow</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-2040.57 866.78,-2040.57 866.78,4 -4,4"/>
<text text-anchor="middle" x="431.39" y="-2013.57" font-family="Microsoft YaHei" font-size="20.00">防火墙数据包处理流程图</text>
<!-- A -->
<g id="node1" class="node">
<title>A</title>
<polygon fill="lightblue" stroke="black" points="823.11,-2001.57 617.37,-2001.57 564.44,-1910.57 770.19,-1910.57 823.11,-2001.57"/>
<text text-anchor="middle" x="693.78" y="-1961.52" font-family="Microsoft YaHei" font-size="14.00">网络数据包到达</text>
<text text-anchor="middle" x="693.78" y="-1942.77" font-family="Microsoft YaHei" font-size="14.00">(来自网络协议栈)</text>
</g>
<!-- B -->
<g id="node2" class="node">
<title>B</title>
<path fill="none" stroke="black" d="M767.78,-1873.57C767.78,-1873.57 619.78,-1873.57 619.78,-1873.57 613.78,-1873.57 607.78,-1867.57 607.78,-1861.57 607.78,-1861.57 607.78,-1849.57 607.78,-1849.57 607.78,-1843.57 613.78,-1837.57 619.78,-1837.57 619.78,-1837.57 767.78,-1837.57 767.78,-1837.57 773.78,-1837.57 779.78,-1843.57 779.78,-1849.57 779.78,-1849.57 779.78,-1861.57 779.78,-1861.57 779.78,-1867.57 773.78,-1873.57 767.78,-1873.57"/>
<text text-anchor="middle" x="693.78" y="-1851.65" font-family="Microsoft YaHei" font-size="14.00">PyDivert驱动捕获数据包</text>
</g>
<!-- A&#45;&gt;B -->
<g id="edge1" class="edge">
<title>A&#45;&gt;B</title>
<path fill="none" stroke="black" d="M693.78,-1910.14C693.78,-1901.62 693.78,-1892.92 693.78,-1885.08"/>
<polygon fill="black" stroke="black" points="697.28,-1885.13 693.78,-1875.13 690.28,-1885.13 697.28,-1885.13"/>
</g>
<!-- C -->
<g id="node3" class="node">
<title>C</title>
<path fill="none" stroke="red" stroke-width="2" d="M784.28,-1800.57C784.28,-1800.57 603.28,-1800.57 603.28,-1800.57 597.28,-1800.57 591.28,-1794.57 591.28,-1788.57 591.28,-1788.57 591.28,-1776.57 591.28,-1776.57 591.28,-1770.57 597.28,-1764.57 603.28,-1764.57 603.28,-1764.57 784.28,-1764.57 784.28,-1764.57 790.28,-1764.57 796.28,-1770.57 796.28,-1776.57 796.28,-1776.57 796.28,-1788.57 796.28,-1788.57 796.28,-1794.57 790.28,-1800.57 784.28,-1800.57"/>
<text text-anchor="middle" x="693.78" y="-1778.65" font-family="Microsoft YaHei" font-size="14.00">PacketInterceptor接收数据包</text>
</g>
<!-- B&#45;&gt;C -->
<g id="edge2" class="edge">
<title>B&#45;&gt;C</title>
<path fill="none" stroke="black" d="M693.78,-1837.38C693.78,-1829.91 693.78,-1820.94 693.78,-1812.49"/>
<polygon fill="black" stroke="black" points="697.28,-1812.61 693.78,-1802.61 690.28,-1812.61 697.28,-1812.61"/>
</g>
<!-- D -->
<g id="node4" class="node">
<title>D</title>
<path fill="none" stroke="black" d="M797.03,-1727.57C797.03,-1727.57 590.53,-1727.57 590.53,-1727.57 584.53,-1727.57 578.53,-1721.57 578.53,-1715.57 578.53,-1715.57 578.53,-1703.57 578.53,-1703.57 578.53,-1697.57 584.53,-1691.57 590.53,-1691.57 590.53,-1691.57 797.03,-1691.57 797.03,-1691.57 803.03,-1691.57 809.03,-1697.57 809.03,-1703.57 809.03,-1703.57 809.03,-1715.57 809.03,-1715.57 809.03,-1721.57 803.03,-1727.57 797.03,-1727.57"/>
<text text-anchor="middle" x="693.78" y="-1705.65" font-family="Microsoft YaHei" font-size="14.00">PacketProcessor.handle_packet()</text>
</g>
<!-- C&#45;&gt;D -->
<g id="edge3" class="edge">
<title>C&#45;&gt;D</title>
<path fill="none" stroke="black" d="M693.78,-1763.65C693.78,-1756.26 693.78,-1747.5 693.78,-1739.25"/>
<polygon fill="black" stroke="black" points="697.28,-1739.26 693.78,-1729.26 690.28,-1739.26 697.28,-1739.26"/>
</g>
<!-- E -->
<g id="node5" class="node">
<title>E</title>
<path fill="none" stroke="red" stroke-width="2" d="M786.53,-1654.57C786.53,-1654.57 601.03,-1654.57 601.03,-1654.57 595.03,-1654.57 589.03,-1648.57 589.03,-1642.57 589.03,-1642.57 589.03,-1621.07 589.03,-1621.07 589.03,-1615.07 595.03,-1609.07 601.03,-1609.07 601.03,-1609.07 786.53,-1609.07 786.53,-1609.07 792.53,-1609.07 798.53,-1615.07 798.53,-1621.07 798.53,-1621.07 798.53,-1642.57 798.53,-1642.57 798.53,-1648.57 792.53,-1654.57 786.53,-1654.57"/>
<text text-anchor="middle" x="693.78" y="-1637.27" font-family="Microsoft YaHei" font-size="14.00">PacketAnalyzer.should_pass()</text>
<text text-anchor="middle" x="693.78" y="-1618.52" font-family="Microsoft YaHei" font-size="14.00">(规则匹配引擎)</text>
</g>
<!-- D&#45;&gt;E -->
<g id="edge4" class="edge">
<title>D&#45;&gt;E</title>
<path fill="none" stroke="black" d="M693.78,-1691.38C693.78,-1684.06 693.78,-1675.25 693.78,-1666.71"/>
<polygon fill="black" stroke="black" points="697.28,-1666.92 693.78,-1656.92 690.28,-1666.92 697.28,-1666.92"/>
</g>
<!-- F_PROTO -->
<g id="node6" class="node">
<title>F_PROTO</title>
<polygon fill="lightyellow" stroke="red" stroke-width="2" points="693.78,-1572.07 524.78,-1545.32 693.78,-1518.57 862.78,-1545.32 693.78,-1572.07"/>
<text text-anchor="middle" x="693.78" y="-1541.4" font-family="Microsoft YaHei" font-size="14.00">1. 协议过滤 (TCP/UDP)?</text>
</g>
<!-- E&#45;&gt;F_PROTO -->
<g id="edge5" class="edge">
<title>E&#45;&gt;F_PROTO</title>
<path fill="none" stroke="black" d="M693.78,-1608.18C693.78,-1600.8 693.78,-1592.4 693.78,-1584.22"/>
<polygon fill="black" stroke="black" points="697.28,-1584.44 693.78,-1574.44 690.28,-1584.44 697.28,-1584.44"/>
</g>
<!-- F_IP_WL -->
<g id="node7" class="node">
<title>F_IP_WL</title>
<polygon fill="lightyellow" stroke="red" stroke-width="2" points="543.78,-1463.82 422.03,-1437.07 543.78,-1410.32 665.53,-1437.07 543.78,-1463.82"/>
<text text-anchor="middle" x="543.78" y="-1433.15" font-family="Microsoft YaHei" font-size="14.00">2. IP白名单匹配?</text>
</g>
<!-- F_PROTO&#45;&gt;F_IP_WL -->
<g id="edge7" class="edge">
<title>F_PROTO&#45;&gt;F_IP_WL</title>
<path fill="none" stroke="black" d="M663.06,-1522.56C639.5,-1505.87 606.86,-1482.75 581.67,-1464.91"/>
<polygon fill="black" stroke="black" points="583.84,-1462.16 573.66,-1459.23 579.79,-1467.87 583.84,-1462.16"/>
<text text-anchor="middle" x="663.38" y="-1487.27" font-family="Microsoft YaHei" font-size="14.00">允许的协议</text>
</g>
<!-- G_BLOCK -->
<g id="node15" class="node">
<title>G_BLOCK</title>
<ellipse fill="lightgreen" stroke="black" cx="514.78" cy="-865.5" rx="56.92" ry="18.92"/>
<text text-anchor="middle" x="514.78" y="-861.57" font-family="Microsoft YaHei" font-size="14.00">标记: 拦截</text>
</g>
<!-- F_PROTO&#45;&gt;G_BLOCK -->
<g id="edge6" class="edge">
<title>F_PROTO&#45;&gt;G_BLOCK</title>
<path fill="none" stroke="black" d="M721.71,-1522.18C743.03,-1502.6 768.78,-1471.94 768.78,-1438.07 768.78,-1438.07 768.78,-1438.07 768.78,-964.91 768.78,-923.64 650.71,-892.9 575.57,-877.51"/>
<polygon fill="black" stroke="black" points="576.33,-874.1 565.84,-875.56 574.96,-880.96 576.33,-874.1"/>
<text text-anchor="middle" x="811.53" y="-1197.57" font-family="Microsoft YaHei" font-size="14.00">不允许的协议</text>
</g>
<!-- F_IP_BL -->
<g id="node8" class="node">
<title>F_IP_BL</title>
<polygon fill="lightyellow" stroke="red" stroke-width="2" points="543.78,-1355.57 422.03,-1328.82 543.78,-1302.07 665.53,-1328.82 543.78,-1355.57"/>
<text text-anchor="middle" x="543.78" y="-1324.9" font-family="Microsoft YaHei" font-size="14.00">3. IP黑名单匹配?</text>
</g>
<!-- F_IP_WL&#45;&gt;F_IP_BL -->
<g id="edge9" class="edge">
<title>F_IP_WL&#45;&gt;F_IP_BL</title>
<path fill="none" stroke="black" d="M543.78,-1409.53C543.78,-1396.86 543.78,-1381.46 543.78,-1367.59"/>
<polygon fill="black" stroke="black" points="547.28,-1367.9 543.78,-1357.9 540.28,-1367.9 547.28,-1367.9"/>
<text text-anchor="middle" x="550.9" y="-1379.02" font-family="Microsoft YaHei" font-size="14.00">否</text>
</g>
<!-- G_ALLOW_IP_WL -->
<g id="node12" class="node">
<title>G_ALLOW_IP_WL</title>
<ellipse fill="lightgreen" stroke="black" cx="251.78" cy="-1265.16" rx="105.18" ry="18.92"/>
<text text-anchor="middle" x="251.78" y="-1261.23" font-family="Microsoft YaHei" font-size="14.00">标记: 放行 (IP白名单)</text>
</g>
<!-- F_IP_WL&#45;&gt;G_ALLOW_IP_WL -->
<g id="edge8" class="edge">
<title>F_IP_WL&#45;&gt;G_ALLOW_IP_WL</title>
<path fill="none" stroke="black" d="M499.07,-1419.21C480.65,-1411.72 459.33,-1402.34 440.78,-1392.32 383.42,-1361.35 321.37,-1317.8 284.58,-1290.81"/>
<polygon fill="black" stroke="black" points="286.68,-1288.01 276.56,-1284.89 282.52,-1293.64 286.68,-1288.01"/>
<text text-anchor="middle" x="490.28" y="-1379.02" font-family="Microsoft YaHei" font-size="14.00">是 (匹配白名单)</text>
</g>
<!-- F_PORT_WL -->
<g id="node9" class="node">
<title>F_PORT_WL</title>
<polygon fill="lightyellow" stroke="red" stroke-width="2" points="465.78,-1228.24 327.53,-1201.49 465.78,-1174.74 604.03,-1201.49 465.78,-1228.24"/>
<text text-anchor="middle" x="465.78" y="-1197.57" font-family="Microsoft YaHei" font-size="14.00">4. 端口白名单匹配?</text>
</g>
<!-- F_IP_BL&#45;&gt;F_PORT_WL -->
<g id="edge11" class="edge">
<title>F_IP_BL&#45;&gt;F_PORT_WL</title>
<path fill="none" stroke="black" d="M529.29,-1304.54C517.22,-1285.14 499.87,-1257.28 486.36,-1235.56"/>
<polygon fill="black" stroke="black" points="489.51,-1234 481.25,-1227.36 483.57,-1237.7 489.51,-1234"/>
<text text-anchor="middle" x="523.45" y="-1261.23" font-family="Microsoft YaHei" font-size="14.00">否</text>
</g>
<!-- F_IP_BL&#45;&gt;G_BLOCK -->
<g id="edge10" class="edge">
<title>F_IP_BL&#45;&gt;G_BLOCK</title>
<path fill="none" stroke="black" d="M573.71,-1307.64C602.53,-1285.54 641.78,-1247.24 641.78,-1202.49 641.78,-1202.49 641.78,-1202.49 641.78,-964.91 641.78,-924.54 601.19,-898.37 565.91,-883.23"/>
<polygon fill="black" stroke="black" points="567.65,-880.16 557.06,-879.64 565.01,-886.65 567.65,-880.16"/>
<text text-anchor="middle" x="691.28" y="-1089.32" font-family="Microsoft YaHei" font-size="14.00">是 (匹配黑名单)</text>
</g>
<!-- F_PORT_BL -->
<g id="node10" class="node">
<title>F_PORT_BL</title>
<polygon fill="lightyellow" stroke="red" stroke-width="2" points="465.78,-1119.99 327.53,-1093.24 465.78,-1066.49 604.03,-1093.24 465.78,-1119.99"/>
<text text-anchor="middle" x="465.78" y="-1089.32" font-family="Microsoft YaHei" font-size="14.00">5. 端口黑名单匹配?</text>
</g>
<!-- F_PORT_WL&#45;&gt;F_PORT_BL -->
<g id="edge13" class="edge">
<title>F_PORT_WL&#45;&gt;F_PORT_BL</title>
<path fill="none" stroke="black" d="M465.78,-1173.95C465.78,-1161.28 465.78,-1145.88 465.78,-1132.01"/>
<polygon fill="black" stroke="black" points="469.28,-1132.32 465.78,-1122.32 462.28,-1132.32 469.28,-1132.32"/>
<text text-anchor="middle" x="472.9" y="-1143.44" font-family="Microsoft YaHei" font-size="14.00">否</text>
</g>
<!-- G_ALLOW_PORT_WL -->
<g id="node13" class="node">
<title>G_ALLOW_PORT_WL</title>
<ellipse fill="lightgreen" stroke="black" cx="297.78" cy="-1029.58" rx="116.85" ry="18.92"/>
<text text-anchor="middle" x="297.78" y="-1025.65" font-family="Microsoft YaHei" font-size="14.00">标记: 放行 (端口白名单)</text>
</g>
<!-- F_PORT_WL&#45;&gt;G_ALLOW_PORT_WL -->
<g id="edge12" class="edge">
<title>F_PORT_WL&#45;&gt;G_ALLOW_PORT_WL</title>
<path fill="none" stroke="black" d="M409.18,-1184.86C376.82,-1172.75 338.79,-1152.43 318.78,-1119.99 307.58,-1101.85 302.35,-1078.26 299.91,-1059.87"/>
<polygon fill="black" stroke="black" points="303.41,-1059.71 298.84,-1050.15 296.46,-1060.47 303.41,-1059.71"/>
<text text-anchor="middle" x="403.77" y="-1143.44" font-family="Microsoft YaHei" font-size="14.00">是 (匹配白名单)</text>
</g>
<!-- F_CONTENT -->
<g id="node11" class="node">
<title>F_CONTENT</title>
<polygon fill="lightyellow" stroke="red" stroke-width="2" points="354.78,-992.66 230.78,-965.91 354.78,-939.16 478.78,-965.91 354.78,-992.66"/>
<text text-anchor="middle" x="354.78" y="-961.99" font-family="Microsoft YaHei" font-size="14.00">6. 内容过滤匹配?</text>
</g>
<!-- F_PORT_BL&#45;&gt;F_CONTENT -->
<g id="edge15" class="edge">
<title>F_PORT_BL&#45;&gt;F_CONTENT</title>
<path fill="none" stroke="black" d="M456.99,-1067.31C449.98,-1049.98 438.83,-1027.12 423.78,-1010.66 417.31,-1003.59 409.45,-997.2 401.39,-991.63"/>
<polygon fill="black" stroke="black" points="403.46,-988.8 393.16,-986.3 399.65,-994.67 403.46,-988.8"/>
<text text-anchor="middle" x="455.49" y="-1025.65" font-family="Microsoft YaHei" font-size="14.00">否</text>
</g>
<!-- F_PORT_BL&#45;&gt;G_BLOCK -->
<g id="edge14" class="edge">
<title>F_PORT_BL&#45;&gt;G_BLOCK</title>
<path fill="none" stroke="black" d="M471.43,-1066.87C475.9,-1046.76 482.28,-1017.92 487.78,-992.66 495.01,-959.4 503.17,-921.18 508.61,-895.6"/>
<polygon fill="black" stroke="black" points="512,-896.46 510.66,-885.95 505.15,-895.01 512,-896.46"/>
<text text-anchor="middle" x="548.48" y="-961.99" font-family="Microsoft YaHei" font-size="14.00">是 (匹配黑名单)</text>
</g>
<!-- G_ALLOW_DEFAULT -->
<g id="node14" class="node">
<title>G_ALLOW_DEFAULT</title>
<ellipse fill="lightgreen" stroke="black" cx="317.78" cy="-865.5" rx="86.62" ry="18.92"/>
<text text-anchor="middle" x="317.78" y="-861.57" font-family="Microsoft YaHei" font-size="14.00">标记: 放行 (默认)</text>
</g>
<!-- F_CONTENT&#45;&gt;G_ALLOW_DEFAULT -->
<g id="edge17" class="edge">
<title>F_CONTENT&#45;&gt;G_ALLOW_DEFAULT</title>
<path fill="none" stroke="black" d="M325.83,-944.71C318.66,-938.11 311.92,-930.13 308.03,-921.16 304.57,-913.2 304.76,-904.07 306.44,-895.58"/>
<polygon fill="black" stroke="black" points="309.79,-896.61 309.08,-886.04 303.04,-894.75 309.79,-896.61"/>
<text text-anchor="middle" x="350.4" y="-907.86" font-family="Microsoft YaHei" font-size="14.00">否 (默认放行)</text>
</g>
<!-- F_CONTENT&#45;&gt;G_BLOCK -->
<g id="edge16" class="edge">
<title>F_CONTENT&#45;&gt;G_BLOCK</title>
<path fill="none" stroke="black" d="M374.71,-942.57C388.85,-927.1 406.9,-908.29 416.03,-902.41 429.48,-893.75 445.31,-886.8 460.3,-881.42"/>
<polygon fill="black" stroke="black" points="461.25,-884.79 469.59,-878.26 459,-878.17 461.25,-884.79"/>
<text text-anchor="middle" x="458.4" y="-907.86" font-family="Microsoft YaHei" font-size="14.00">是 (匹配内容)</text>
</g>
<!-- H -->
<g id="node16" class="node">
<title>H</title>
<path fill="none" stroke="black" d="M326.78,-809.58C326.78,-809.58 148.78,-809.58 148.78,-809.58 142.78,-809.58 136.78,-803.58 136.78,-797.58 136.78,-797.58 136.78,-776.08 136.78,-776.08 136.78,-770.08 142.78,-764.08 148.78,-764.08 148.78,-764.08 326.78,-764.08 326.78,-764.08 332.78,-764.08 338.78,-770.08 338.78,-776.08 338.78,-776.08 338.78,-797.58 338.78,-797.58 338.78,-803.58 332.78,-809.58 326.78,-809.58"/>
<text text-anchor="middle" x="237.78" y="-792.28" font-family="Microsoft YaHei" font-size="14.00">PacketAnalyzer返回分析结果</text>
<text text-anchor="middle" x="237.78" y="-773.53" font-family="Microsoft YaHei" font-size="14.00">(放行/拦截)</text>
</g>
<!-- G_ALLOW_IP_WL&#45;&gt;H -->
<g id="edge18" class="edge">
<title>G_ALLOW_IP_WL&#45;&gt;H</title>
<path fill="none" stroke="black" d="M226.61,-1246.39C200.92,-1225.96 164.78,-1189.85 164.78,-1148.37 164.78,-1148.37 164.78,-1148.37 164.78,-864.5 164.78,-845.44 176.75,-829.25 190.99,-816.73"/>
<polygon fill="black" stroke="black" points="192.82,-819.75 198.39,-810.73 188.42,-814.31 192.82,-819.75"/>
</g>
<!-- G_ALLOW_PORT_WL&#45;&gt;H -->
<g id="edge19" class="edge">
<title>G_ALLOW_PORT_WL&#45;&gt;H</title>
<path fill="none" stroke="black" d="M243.61,-1012.48C234.94,-1007.51 227.09,-1001.04 221.78,-992.66 188.4,-939.97 208.09,-863.69 223.92,-820.63"/>
<polygon fill="black" stroke="black" points="227.17,-821.93 227.49,-811.34 220.64,-819.42 227.17,-821.93"/>
</g>
<!-- G_ALLOW_DEFAULT&#45;&gt;H -->
<g id="edge20" class="edge">
<title>G_ALLOW_DEFAULT&#45;&gt;H</title>
<path fill="none" stroke="black" d="M299.22,-846.71C290.28,-838.14 279.31,-827.63 269.12,-817.87"/>
<polygon fill="black" stroke="black" points="271.54,-815.34 261.9,-810.95 266.7,-820.4 271.54,-815.34"/>
</g>
<!-- G_BLOCK&#45;&gt;H -->
<g id="edge21" class="edge">
<title>G_BLOCK&#45;&gt;H</title>
<path fill="none" stroke="black" d="M472.1,-852.68C434.16,-842.18 377.4,-826.47 329.24,-813.14"/>
<polygon fill="black" stroke="black" points="330.19,-809.77 319.62,-810.48 328.32,-816.52 330.19,-809.77"/>
</g>
<!-- I -->
<g id="node17" class="node">
<title>I</title>
<path fill="none" stroke="red" stroke-width="2" d="M316.28,-727.08C316.28,-727.08 159.28,-727.08 159.28,-727.08 153.28,-727.08 147.28,-721.08 147.28,-715.08 147.28,-715.08 147.28,-703.08 147.28,-703.08 147.28,-697.08 153.28,-691.08 159.28,-691.08 159.28,-691.08 316.28,-691.08 316.28,-691.08 322.28,-691.08 328.28,-697.08 328.28,-703.08 328.28,-703.08 328.28,-715.08 328.28,-715.08 328.28,-721.08 322.28,-727.08 316.28,-727.08"/>
<text text-anchor="middle" x="237.78" y="-705.16" font-family="Microsoft YaHei" font-size="14.00">PacketProcessor执行动作</text>
</g>
<!-- H&#45;&gt;I -->
<g id="edge22" class="edge">
<title>H&#45;&gt;I</title>
<path fill="none" stroke="black" d="M237.78,-763.92C237.78,-756.17 237.78,-747.33 237.78,-739.08"/>
<polygon fill="black" stroke="black" points="241.28,-739.13 237.78,-729.13 234.28,-739.13 241.28,-739.13"/>
</g>
<!-- J_DECISION -->
<g id="node18" class="node">
<title>J_DECISION</title>
<polygon fill="lightyellow" stroke="red" stroke-width="2" points="237.78,-654.08 131.78,-627.33 237.78,-600.58 343.78,-627.33 237.78,-654.08"/>
<text text-anchor="middle" x="237.78" y="-623.41" font-family="Microsoft YaHei" font-size="14.00">结果是&quot;放行&quot;?</text>
</g>
<!-- I&#45;&gt;J_DECISION -->
<g id="edge23" class="edge">
<title>I&#45;&gt;J_DECISION</title>
<path fill="none" stroke="black" d="M237.78,-690.38C237.78,-683.25 237.78,-674.73 237.78,-666.33"/>
<polygon fill="black" stroke="black" points="241.28,-666.59 237.78,-656.59 234.28,-666.59 241.28,-666.59"/>
</g>
<!-- K_SEND -->
<g id="node19" class="node">
<title>K_SEND</title>
<path fill="none" stroke="black" d="M256.53,-545.83C256.53,-545.83 101.03,-545.83 101.03,-545.83 95.03,-545.83 89.03,-539.83 89.03,-533.83 89.03,-533.83 89.03,-521.83 89.03,-521.83 89.03,-515.83 95.03,-509.83 101.03,-509.83 101.03,-509.83 256.53,-509.83 256.53,-509.83 262.53,-509.83 268.53,-515.83 268.53,-521.83 268.53,-521.83 268.53,-533.83 268.53,-533.83 268.53,-539.83 262.53,-545.83 256.53,-545.83"/>
<text text-anchor="middle" x="178.78" y="-523.91" font-family="Microsoft YaHei" font-size="14.00">调用 _send_packet_safe()</text>
</g>
<!-- J_DECISION&#45;&gt;K_SEND -->
<g id="edge24" class="edge">
<title>J_DECISION&#45;&gt;K_SEND</title>
<path fill="none" stroke="black" d="M223.8,-603.22C215.21,-589.04 204.18,-570.81 195.18,-555.94"/>
<polygon fill="black" stroke="black" points="198.29,-554.32 190.12,-547.58 192.3,-557.94 198.29,-554.32"/>
<text text-anchor="middle" x="238.17" y="-569.28" font-family="Microsoft YaHei" font-size="14.00">是 (放行)</text>
</g>
<!-- O_DROP -->
<g id="node23" class="node">
<title>O_DROP</title>
<ellipse fill="lightgreen" stroke="red" stroke-width="2" cx="296.78" cy="-472.92" rx="61.7" ry="18.92"/>
<text text-anchor="middle" x="296.78" y="-468.99" font-family="Microsoft YaHei" font-size="14.00">数据包丢弃</text>
</g>
<!-- J_DECISION&#45;&gt;O_DROP -->
<g id="edge28" class="edge">
<title>J_DECISION&#45;&gt;O_DROP</title>
<path fill="none" stroke="black" d="M256.8,-604.77C261.96,-598.03 267.13,-590.33 270.78,-582.58 282.63,-557.45 289.36,-526.41 292.99,-503.96"/>
<polygon fill="black" stroke="black" points="296.42,-504.66 294.43,-494.26 289.5,-503.63 296.42,-504.66"/>
<text text-anchor="middle" x="306.28" y="-569.28" font-family="Microsoft YaHei" font-size="14.00">否 (拦截)</text>
</g>
<!-- L_INTERCEPTOR_SEND -->
<g id="node20" class="node">
<title>L_INTERCEPTOR_SEND</title>
<path fill="none" stroke="black" d="M222.78,-436C222.78,-436 68.78,-436 68.78,-436 62.78,-436 56.78,-430 56.78,-424 56.78,-424 56.78,-412 56.78,-412 56.78,-406 62.78,-400 68.78,-400 68.78,-400 222.78,-400 222.78,-400 228.78,-400 234.78,-406 234.78,-412 234.78,-412 234.78,-424 234.78,-424 234.78,-430 228.78,-436 222.78,-436"/>
<text text-anchor="middle" x="145.78" y="-414.07" font-family="Microsoft YaHei" font-size="14.00">PacketInterceptor.send()</text>
</g>
<!-- K_SEND&#45;&gt;L_INTERCEPTOR_SEND -->
<g id="edge25" class="edge">
<title>K_SEND&#45;&gt;L_INTERCEPTOR_SEND</title>
<path fill="none" stroke="black" d="M173.48,-509.51C168.33,-492.68 160.43,-466.87 154.38,-447.1"/>
<polygon fill="black" stroke="black" points="157.78,-446.27 151.51,-437.73 151.09,-448.32 157.78,-446.27"/>
</g>
<!-- M_PYDIVERT_SEND -->
<g id="node21" class="node">
<title>M_PYDIVERT_SEND</title>
<path fill="none" stroke="black" d="M198.53,-363C198.53,-363 79.03,-363 79.03,-363 73.03,-363 67.03,-357 67.03,-351 67.03,-351 67.03,-339 67.03,-339 67.03,-333 73.03,-327 79.03,-327 79.03,-327 198.53,-327 198.53,-327 204.53,-327 210.53,-333 210.53,-339 210.53,-339 210.53,-351 210.53,-351 210.53,-357 204.53,-363 198.53,-363"/>
<text text-anchor="middle" x="138.78" y="-341.07" font-family="Microsoft YaHei" font-size="14.00">PyDivert注入数据包</text>
</g>
<!-- L_INTERCEPTOR_SEND&#45;&gt;M_PYDIVERT_SEND -->
<g id="edge26" class="edge">
<title>L_INTERCEPTOR_SEND&#45;&gt;M_PYDIVERT_SEND</title>
<path fill="none" stroke="black" d="M144.08,-399.81C143.33,-392.14 142.42,-382.89 141.56,-374.24"/>
<polygon fill="black" stroke="black" points="145.07,-374.14 140.61,-364.54 138.1,-374.83 145.07,-374.14"/>
</g>
<!-- N_PACKET_OUT -->
<g id="node22" class="node">
<title>N_PACKET_OUT</title>
<polygon fill="lightblue" stroke="red" stroke-width="2" points="269.56,-290 55.15,-290 0,-236.5 214.4,-236.5 269.56,-290"/>
<text text-anchor="middle" x="134.78" y="-259.32" font-family="Microsoft YaHei" font-size="14.00">数据包发出至网络</text>
</g>
<!-- M_PYDIVERT_SEND&#45;&gt;N_PACKET_OUT -->
<g id="edge27" class="edge">
<title>M_PYDIVERT_SEND&#45;&gt;N_PACKET_OUT</title>
<path fill="none" stroke="black" d="M137.91,-326.7C137.55,-319.51 137.12,-310.88 136.69,-302.35"/>
<polygon fill="black" stroke="black" points="140.19,-302.26 136.19,-292.45 133.2,-302.61 140.19,-302.26"/>
</g>
<!-- P -->
<g id="node24" class="node">
<title>P</title>
<path fill="none" stroke="black" d="M294.28,-199.5C294.28,-199.5 137.28,-199.5 137.28,-199.5 131.28,-199.5 125.28,-193.5 125.28,-187.5 125.28,-187.5 125.28,-175.5 125.28,-175.5 125.28,-169.5 131.28,-163.5 137.28,-163.5 137.28,-163.5 294.28,-163.5 294.28,-163.5 300.28,-163.5 306.28,-169.5 306.28,-175.5 306.28,-175.5 306.28,-187.5 306.28,-187.5 306.28,-193.5 300.28,-199.5 294.28,-199.5"/>
<text text-anchor="middle" x="215.78" y="-177.57" font-family="Microsoft YaHei" font-size="14.00">PacketProcessor更新统计</text>
</g>
<!-- N_PACKET_OUT&#45;&gt;P -->
<g id="edge29" class="edge">
<title>N_PACKET_OUT&#45;&gt;P</title>
<path fill="none" stroke="black" d="M161.75,-235.69C170.82,-226.77 180.91,-216.83 189.89,-207.99"/>
<polygon fill="black" stroke="black" points="192.34,-210.48 197.01,-200.97 187.43,-205.5 192.34,-210.48"/>
</g>
<!-- O_DROP&#45;&gt;P -->
<g id="edge30" class="edge">
<title>O_DROP&#45;&gt;P</title>
<path fill="none" stroke="black" d="M297.11,-453.32C297.4,-435.14 297.78,-406.67 297.78,-382 297.78,-382 297.78,-382 297.78,-262.25 297.78,-238.53 279.92,-219.58 260.88,-206.12"/>
<polygon fill="black" stroke="black" points="263.05,-203.35 252.77,-200.78 259.2,-209.2 263.05,-203.35"/>
</g>
<!-- Q -->
<g id="node25" class="node">
<title>Q</title>
<path fill="none" stroke="black" d="M349.78,-126.5C349.78,-126.5 81.78,-126.5 81.78,-126.5 75.78,-126.5 69.78,-120.5 69.78,-114.5 69.78,-114.5 69.78,-102.5 69.78,-102.5 69.78,-96.5 75.78,-90.5 81.78,-90.5 81.78,-90.5 349.78,-90.5 349.78,-90.5 355.78,-90.5 361.78,-96.5 361.78,-102.5 361.78,-102.5 361.78,-114.5 361.78,-114.5 361.78,-120.5 355.78,-126.5 349.78,-126.5"/>
<text text-anchor="middle" x="215.78" y="-104.58" font-family="Microsoft YaHei" font-size="14.00">调用回调 (Firewall &#45;&gt; MainWindow &#45;&gt; UI)</text>
</g>
<!-- P&#45;&gt;Q -->
<g id="edge31" class="edge">
<title>P&#45;&gt;Q</title>
<path fill="none" stroke="black" d="M215.78,-163.31C215.78,-155.73 215.78,-146.6 215.78,-138.04"/>
<polygon fill="black" stroke="black" points="219.28,-138.04 215.78,-128.04 212.28,-138.04 219.28,-138.04"/>
</g>
<!-- R -->
<g id="node26" class="node">
<title>R</title>
<polygon fill="lightblue" stroke="red" stroke-width="2" points="385.55,-53.5 115.48,-53.5 46.01,0 316.07,0 385.55,-53.5"/>
<text text-anchor="middle" x="215.78" y="-22.82" font-family="Microsoft YaHei" font-size="14.00">UI界面更新 (流量/日志)</text>
</g>
<!-- Q&#45;&gt;R -->
<g id="edge32" class="edge">
<title>Q&#45;&gt;R</title>
<path fill="none" stroke="black" d="M215.78,-90.2C215.78,-83.01 215.78,-74.38 215.78,-65.85"/>
<polygon fill="black" stroke="black" points="219.28,-65.95 215.78,-55.95 212.28,-65.95 219.28,-65.95"/>
</g>
</g>
</svg>
