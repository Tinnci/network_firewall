<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: Firewall_Packet_Capture_Protocol_Filter Pages: 1 -->
<svg width="670pt" height="1008pt"
 viewBox="0.00 0.00 669.67 1008.33" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1004.33)">
<title>Firewall_Packet_Capture_Protocol_Filter</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1004.33 665.67,-1004.33 665.67,4 -4,4"/>
<text text-anchor="middle" x="330.83" y="-977.33" font-family="Microsoft YaHei" font-size="20.00">数据包捕获与协议过滤流程图</text>
<!-- Start -->
<g id="node1" class="node">
<title>Start</title>
<polygon fill="lightblue" stroke="black" points="601.43,-965.33 301.68,-965.33 224.57,-874.33 524.32,-874.33 601.43,-965.33"/>
<text text-anchor="middle" x="413" y="-925.28" font-family="Microsoft YaHei" font-size="14.00">网络数据包到达</text>
<text text-anchor="middle" x="413" y="-906.53" font-family="Microsoft YaHei" font-size="14.00">(来自操作系统网络协议栈)</text>
</g>
<!-- PyDivertDriver -->
<g id="node2" class="node">
<title>PyDivertDriver</title>
<polygon fill="lightgreen" stroke="red" stroke-width="2" points="500.12,-837.33 325.88,-837.33 325.88,-801.33 500.12,-801.33 500.12,-837.33"/>
<text text-anchor="middle" x="413" y="-815.41" font-family="Microsoft YaHei" font-size="14.00">PyDivert/WinDivert驱动</text>
</g>
<!-- Start&#45;&gt;PyDivertDriver -->
<g id="edge1" class="edge">
<title>Start&#45;&gt;PyDivertDriver</title>
<path fill="none" stroke="black" d="M413,-873.9C413,-865.51 413,-856.95 413,-849.21"/>
<polygon fill="black" stroke="black" points="416.5,-849.37 413,-839.37 409.5,-849.37 416.5,-849.37"/>
</g>
<!-- InterceptorRecvLoop -->
<g id="node3" class="node">
<title>InterceptorRecvLoop</title>
<polygon fill="lightgreen" stroke="red" stroke-width="2" points="530.5,-746.58 295.5,-746.58 295.5,-710.58 530.5,-710.58 530.5,-746.58"/>
<text text-anchor="middle" x="413" y="-724.66" font-family="Microsoft YaHei" font-size="14.00">PacketInterceptor._receive_loop()</text>
</g>
<!-- PyDivertDriver&#45;&gt;InterceptorRecvLoop -->
<g id="edge2" class="edge">
<title>PyDivertDriver&#45;&gt;InterceptorRecvLoop</title>
<path fill="none" stroke="black" d="M413,-800.37C413,-788.46 413,-772.56 413,-758.85"/>
<polygon fill="black" stroke="black" points="416.5,-759.03 413,-749.03 409.5,-759.03 416.5,-759.03"/>
<text text-anchor="middle" x="427.25" y="-770.03" font-family="Microsoft YaHei" font-size="14.00">捕获</text>
</g>
<!-- RecvPacket -->
<g id="node4" class="node">
<title>RecvPacket</title>
<path fill="lightyellow" stroke="black" d="M448,-673.58C448,-673.58 378,-673.58 378,-673.58 372,-673.58 366,-667.58 366,-661.58 366,-661.58 366,-640.08 366,-640.08 366,-634.08 372,-628.08 378,-628.08 378,-628.08 448,-628.08 448,-628.08 454,-628.08 460,-634.08 460,-640.08 460,-640.08 460,-661.58 460,-661.58 460,-667.58 454,-673.58 448,-673.58"/>
<text text-anchor="middle" x="413" y="-656.28" font-family="Microsoft YaHei" font-size="14.00">divert.recv()</text>
<text text-anchor="middle" x="413" y="-637.53" font-family="Microsoft YaHei" font-size="14.00">接收数据包</text>
</g>
<!-- InterceptorRecvLoop&#45;&gt;RecvPacket -->
<g id="edge3" class="edge">
<title>InterceptorRecvLoop&#45;&gt;RecvPacket</title>
<path fill="none" stroke="black" d="M413,-709.63C413,-702.37 413,-693.75 413,-685.41"/>
<polygon fill="black" stroke="black" points="416.5,-685.5 413,-675.5 409.5,-685.5 416.5,-685.5"/>
</g>
<!-- PassToProcessor -->
<g id="node5" class="node">
<title>PassToProcessor</title>
<path fill="lightyellow" stroke="black" d="M530.5,-573.33C530.5,-573.33 295.5,-573.33 295.5,-573.33 289.5,-573.33 283.5,-567.33 283.5,-561.33 283.5,-561.33 283.5,-549.33 283.5,-549.33 283.5,-543.33 289.5,-537.33 295.5,-537.33 295.5,-537.33 530.5,-537.33 530.5,-537.33 536.5,-537.33 542.5,-543.33 542.5,-549.33 542.5,-549.33 542.5,-561.33 542.5,-561.33 542.5,-567.33 536.5,-573.33 530.5,-573.33"/>
<text text-anchor="middle" x="413" y="-551.41" font-family="Microsoft YaHei" font-size="14.00">调用PacketProcessor.handle_packet()</text>
</g>
<!-- RecvPacket&#45;&gt;PassToProcessor -->
<g id="edge4" class="edge">
<title>RecvPacket&#45;&gt;PassToProcessor</title>
<path fill="none" stroke="black" d="M413,-627.67C413,-614.89 413,-598.68 413,-584.95"/>
<polygon fill="black" stroke="black" points="416.5,-585.17 413,-575.17 409.5,-585.17 416.5,-585.17"/>
<text text-anchor="middle" x="448.62" y="-596.78" font-family="Microsoft YaHei" font-size="14.00">获得数据包</text>
</g>
<!-- ProcessorRequestsAnalysis -->
<g id="node6" class="node">
<title>ProcessorRequestsAnalysis</title>
<polygon fill="lightgreen" stroke="black" points="489.25,-500.33 336.75,-500.33 336.75,-454.83 489.25,-454.83 489.25,-500.33"/>
<text text-anchor="middle" x="413" y="-483.03" font-family="Microsoft YaHei" font-size="14.00">PacketProcessor请求</text>
<text text-anchor="middle" x="413" y="-464.28" font-family="Microsoft YaHei" font-size="14.00">PacketAnalyzer分析</text>
</g>
<!-- PassToProcessor&#45;&gt;ProcessorRequestsAnalysis -->
<g id="edge5" class="edge">
<title>PassToProcessor&#45;&gt;ProcessorRequestsAnalysis</title>
<path fill="none" stroke="black" d="M413,-537.14C413,-529.7 413,-520.72 413,-512.05"/>
<polygon fill="black" stroke="black" points="416.5,-512.11 413,-502.11 409.5,-512.11 416.5,-512.11"/>
</g>
<!-- AnalyzerChecksProtocol -->
<g id="node7" class="node">
<title>AnalyzerChecksProtocol</title>
<polygon fill="lightcoral" stroke="red" stroke-width="2" points="413,-400.08 202,-354.58 413,-309.08 624,-354.58 413,-400.08"/>
<text text-anchor="middle" x="413" y="-360.03" font-family="Microsoft YaHei" font-size="14.00">PacketAnalyzer: 检查协议类型</text>
<text text-anchor="middle" x="413" y="-341.28" font-family="Microsoft YaHei" font-size="14.00">(TCP/UDP?)</text>
</g>
<!-- ProcessorRequestsAnalysis&#45;&gt;AnalyzerChecksProtocol -->
<g id="edge6" class="edge">
<title>ProcessorRequestsAnalysis&#45;&gt;AnalyzerChecksProtocol</title>
<path fill="none" stroke="black" d="M413,-454.39C413,-442.48 413,-427.21 413,-412.26"/>
<polygon fill="black" stroke="black" points="416.5,-412.45 413,-402.45 409.5,-412.45 416.5,-412.45"/>
<text text-anchor="middle" x="441.5" y="-423.53" font-family="Microsoft YaHei" font-size="14.00">分析请求</text>
</g>
<!-- NonTCPUDP -->
<g id="node8" class="node">
<title>NonTCPUDP</title>
<polygon fill="lightcoral" stroke="black" points="277,-254.33 137.25,-227.58 277,-200.83 416.75,-227.58 277,-254.33"/>
<text text-anchor="middle" x="277" y="-223.66" font-family="Microsoft YaHei" font-size="14.00">非TCP/UDP数据包?</text>
</g>
<!-- AnalyzerChecksProtocol&#45;&gt;NonTCPUDP -->
<g id="edge7" class="edge">
<title>AnalyzerChecksProtocol&#45;&gt;NonTCPUDP</title>
<path fill="none" stroke="black" d="M372.93,-316.75C352.55,-298.02 328.11,-275.56 309,-257.99"/>
<polygon fill="black" stroke="black" points="311.48,-255.51 301.75,-251.32 306.74,-260.67 311.48,-255.51"/>
<text text-anchor="middle" x="386.25" y="-277.78" font-family="Microsoft YaHei" font-size="14.00">是TCP或UDP</text>
</g>
<!-- AllowNonTCPUDP -->
<g id="node9" class="node">
<title>AllowNonTCPUDP</title>
<ellipse fill="palegreen" stroke="black" cx="548" cy="-227.58" rx="113.67" ry="18.92"/>
<text text-anchor="middle" x="548" y="-223.66" font-family="Microsoft YaHei" font-size="14.00">默认放行 (非TCP/UDP)</text>
</g>
<!-- AnalyzerChecksProtocol&#45;&gt;AllowNonTCPUDP -->
<g id="edge8" class="edge">
<title>AnalyzerChecksProtocol&#45;&gt;AllowNonTCPUDP</title>
<path fill="none" stroke="black" d="M452.77,-316.75C474.49,-296.64 500.84,-272.24 520.32,-254.21"/>
<polygon fill="black" stroke="black" points="522.67,-256.81 527.63,-247.44 517.91,-251.67 522.67,-256.81"/>
<text text-anchor="middle" x="528.98" y="-277.78" font-family="Microsoft YaHei" font-size="14.00">其他协议</text>
</g>
<!-- CheckTCPAllowed -->
<g id="node10" class="node">
<title>CheckTCPAllowed</title>
<polygon fill="lightcoral" stroke="black" points="133,-146.08 0,-119.33 133,-92.58 266,-119.33 133,-146.08"/>
<text text-anchor="middle" x="133" y="-115.41" font-family="Microsoft YaHei" font-size="14.00">TCP协议是否允许?</text>
</g>
<!-- NonTCPUDP&#45;&gt;CheckTCPAllowed -->
<g id="edge9" class="edge">
<title>NonTCPUDP&#45;&gt;CheckTCPAllowed</title>
<path fill="none" stroke="black" d="M248.89,-205.84C226.25,-189.13 194.24,-165.52 169.6,-147.33"/>
<polygon fill="black" stroke="black" points="171.89,-144.67 161.76,-141.55 167.73,-150.31 171.89,-144.67"/>
<text text-anchor="middle" x="233.12" y="-169.53" font-family="Microsoft YaHei" font-size="14.00">是TCP</text>
</g>
<!-- CheckUDPAllowed -->
<g id="node11" class="node">
<title>CheckUDPAllowed</title>
<polygon fill="lightcoral" stroke="black" points="422,-146.08 284.5,-119.33 422,-92.58 559.5,-119.33 422,-146.08"/>
<text text-anchor="middle" x="422" y="-115.41" font-family="Microsoft YaHei" font-size="14.00">UDP协议是否允许?</text>
</g>
<!-- NonTCPUDP&#45;&gt;CheckUDPAllowed -->
<g id="edge10" class="edge">
<title>NonTCPUDP&#45;&gt;CheckUDPAllowed</title>
<path fill="none" stroke="black" d="M305.3,-205.84C327.96,-189.24 359.92,-165.82 384.67,-147.68"/>
<polygon fill="black" stroke="black" points="386.55,-150.64 392.55,-141.91 382.41,-145 386.55,-150.64"/>
<text text-anchor="middle" x="379.93" y="-169.53" font-family="Microsoft YaHei" font-size="14.00">是UDP</text>
</g>
<!-- BlockProtocol -->
<g id="node12" class="node">
<title>BlockProtocol</title>
<ellipse fill="palegreen" stroke="red" stroke-width="2" cx="182" cy="-18.92" rx="101.47" ry="18.92"/>
<text text-anchor="middle" x="182" y="-14.99" font-family="Microsoft YaHei" font-size="14.00">标记拦截 (协议禁止)</text>
</g>
<!-- CheckTCPAllowed&#45;&gt;BlockProtocol -->
<g id="edge11" class="edge">
<title>CheckTCPAllowed&#45;&gt;BlockProtocol</title>
<path fill="none" stroke="black" d="M120.61,-94.81C115.93,-82.53 113.19,-67.64 120,-55.83 122.59,-51.34 125.97,-47.37 129.82,-43.85"/>
<polygon fill="black" stroke="black" points="131.9,-46.67 137.69,-37.8 127.63,-41.13 131.9,-46.67"/>
<text text-anchor="middle" x="160.5" y="-61.28" font-family="Microsoft YaHei" font-size="14.00">否 (TCP禁止)</text>
</g>
<!-- ContinueToIPFilter -->
<g id="node13" class="node">
<title>ContinueToIPFilter</title>
<path fill="lightyellow" stroke="black" d="M463,-36.92C463,-36.92 345,-36.92 345,-36.92 339,-36.92 333,-30.92 333,-24.92 333,-24.92 333,-12.92 333,-12.92 333,-6.92 339,-0.92 345,-0.92 345,-0.92 463,-0.92 463,-0.92 469,-0.92 475,-6.92 475,-12.92 475,-12.92 475,-24.92 475,-24.92 475,-30.92 469,-36.92 463,-36.92"/>
<text text-anchor="middle" x="404" y="-14.99" font-family="Microsoft YaHei" font-size="14.00">继续进行IP地址过滤</text>
</g>
<!-- CheckTCPAllowed&#45;&gt;ContinueToIPFilter -->
<g id="edge12" class="edge">
<title>CheckTCPAllowed&#45;&gt;ContinueToIPFilter</title>
<path fill="none" stroke="black" d="M166.12,-98.95C177.53,-91.78 190.15,-83.27 201,-74.58 210.26,-67.16 209.51,-61.37 220,-55.83 229.39,-50.87 276.98,-41.64 321.41,-33.78"/>
<polygon fill="black" stroke="black" points="321.88,-37.25 331.12,-32.08 320.67,-30.36 321.88,-37.25"/>
<text text-anchor="middle" x="260.5" y="-61.28" font-family="Microsoft YaHei" font-size="14.00">是 (TCP允许)</text>
</g>
<!-- CheckUDPAllowed&#45;&gt;BlockProtocol -->
<g id="edge13" class="edge">
<title>CheckUDPAllowed&#45;&gt;BlockProtocol</title>
<path fill="none" stroke="black" d="M375.63,-101.38C358.85,-94.26 340.18,-85.17 324.5,-74.58 314.53,-67.85 315.4,-61.86 305,-55.83 291.6,-48.07 276.39,-41.87 261.35,-36.97"/>
<polygon fill="black" stroke="black" points="262.5,-33.66 251.91,-34.06 260.44,-40.35 262.5,-33.66"/>
<text text-anchor="middle" x="367.25" y="-61.28" font-family="Microsoft YaHei" font-size="14.00">否 (UDP禁止)</text>
</g>
<!-- CheckUDPAllowed&#45;&gt;ContinueToIPFilter -->
<g id="edge14" class="edge">
<title>CheckUDPAllowed&#45;&gt;ContinueToIPFilter</title>
<path fill="none" stroke="black" d="M419.56,-92.65C418.26,-81.3 416.43,-67.84 414,-55.83 413.5,-53.36 412.92,-50.8 412.3,-48.25"/>
<polygon fill="black" stroke="black" points="415.73,-47.56 409.78,-38.79 408.97,-49.36 415.73,-47.56"/>
<text text-anchor="middle" x="459.71" y="-61.28" font-family="Microsoft YaHei" font-size="14.00">是 (UDP允许)</text>
</g>
</g>
</svg>
